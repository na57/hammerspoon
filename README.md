# Hammerspoon 自动化配置

## 📖 项目简介

**Hammerspoon 自动化配置** 是一个专为 macOS 用户设计的自动化工具集合，通过简单的快捷键组合，让您能够轻松管理显示器、窗口、文件和鼠标等日常操作。

### 开发背景

在日常使用 Mac 电脑时，我们经常需要重复执行一些操作，比如在多个显示器之间切换窗口、清除屏幕残影、将文件移动到 iCloud 等。这些操作虽然简单，但频繁执行会浪费大量时间。本项目基于 Hammerspoon 框架开发，通过预设的快捷键，一键完成这些操作，大大提高工作效率。

### 主要目标

- 简化日常操作，减少重复劳动
- 提高工作效率，让 Mac 使用更加流畅
- 提供易于自定义的配置方案
- 适合所有水平的用户使用

---

## ✨ 核心功能特点

### 1. 🖥️ 显示器智能管理

**功能描述**：一键在多个显示器之间切换窗口，支持全屏窗口的无缝切换，同时提供清除显示器残影的功能。

**使用场景**：
- 在双显示器或多显示器环境下快速移动窗口
- 解决显示器切换后出现的屏幕残影问题
- 保持窗口在不同显示器上的相对位置不变

**快捷键**：`Hyper + M`（切换显示器）、`Hyper + G`（清除残影）

---

### 2. 🪟 窗口全屏切换

**功能描述**：快速切换当前窗口的全屏状态，无需使用鼠标点击窗口控制按钮。

**使用场景**：
- 需要专注工作时快速进入全屏模式
- 在全屏和窗口模式之间快速切换
- 提升视觉体验和工作专注度

**快捷键**：`Hyper + P`

---

### 3. ☁️ iCloud 文件快速移动

**功能描述**：将 Finder 中选中的文件一键移动到 iCloud 指定目录，支持批量移动多个文件。

**使用场景**：
- 快速备份文件到 iCloud
- 整理文件到指定文件夹
- 批量处理多个文件的移动操作

**快捷键**：`Hyper + 2`

**使用方法**：
1. 在 Finder 中选中要移动的文件（可多选）
2. 按下 `Hyper + 2`
3. 文件会自动移动到 iCloud 的指定目录

---

### 4. 🖱️ 鼠标自动移动

**功能描述**：启动后，鼠标会在屏幕中央区域随机移动，防止电脑进入休眠状态或保持活跃状态。

**使用场景**：
- 下载大文件时防止电脑休眠
- 演示或展示时保持屏幕常亮
- 需要长时间保持电脑活跃状态

**快捷键**：`Hyper + 5`（启动）、`Hyper + 6`（停止）

---

### 5. ⚡ 配置快速重载

**功能描述**：修改配置文件后，无需重启 Hammerspoon，一键重新加载配置，立即生效。

**使用场景**：
- 自定义快捷键后立即应用
- 修改功能参数后快速生效
- 调试和测试配置更改

**快捷键**：`Hyper + R`

---

## 🚀 使用方法

### 安装步骤

#### 第一步：安装 Hammerspoon

1. 打开浏览器，访问 Hammerspoon 官网：[https://www.hammerspoon.org/](https://www.hammerspoon.org/)
2. 点击页面上的"Download"按钮下载最新版本
3. 下载完成后，双击 `.dmg` 文件打开安装包
4. 将 Hammerspoon 图标拖拽到"应用程序"文件夹
5. 在"应用程序"文件夹中找到 Hammerspoon 并启动它

#### 第二步：配置文件设置

1. 启动 Hammerspoon 后，点击菜单栏中的 Hammerspoon 图标（锤子形状）
2. 选择"Open Config"选项，这会打开配置文件所在的文件夹
3. 将本项目的所有文件复制到该文件夹中：
   - `init.lua`（主配置文件）
   - `display.lua`（显示器管理模块）
   - `window.lua`（窗口管理模块）
   - `icloud.lua`（iCloud 文件管理模块）
   - `mouse.lua`（鼠标控制模块）

#### 第三步：加载配置

1. 确保所有文件都已正确放置在配置文件夹中
2. 点击菜单栏中的 Hammerspoon 图标
3. 选择"Reload Config"选项
4. 如果配置成功，屏幕上会显示提示："Hammerspoon 配置已加载！"

---

### 基本操作流程

#### 使用快捷键

所有功能都通过"Hyper 键 + 字母键"的组合来触发：

**Hyper 键** = `Command (⌘)` + `Shift (⇧)` + `Option (⌥)`

**使用方法**：
1. 同时按住 `Command`、`Shift` 和 `Option` 三个键
2. 保持按住这三个键的同时，按下对应的字母键或数字键
3. 释放所有按键，功能即被触发

**示例**：
- 要切换显示器，按住 `⌘` + `⇧` + `⌥`，然后按 `M` 键
- 要启动鼠标移动，按住 `⌘` + `⇧` + `⌥`，然后按 `5` 键

---

### 常见任务实现方式

#### 任务一：在多个显示器之间移动窗口

**步骤**：
1. 确保已连接多个显示器
2. 点击要移动的窗口，使其成为当前活动窗口
3. 按下 `Hyper + M`（即 `⌘` + `⇧` + `⌥` + `M`）
4. 窗口会自动移动到下一个显示器

**注意**：
- 支持全屏窗口的移动
- 窗口在移动过程中会自动调整位置，避免残影

---

#### 任务二：清除显示器残影

**步骤**：
1. 如果发现显示器上有残影或显示异常
2. 按下 `Hyper + G`（即 `⌘` + `⇧` + `⌥` + `G`）
3. 系统会自动清除所有显示器的残影
4. 屏幕上会显示提示："已清除所有显示器残影"

---

#### 任务三：将文件移动到 iCloud

**步骤**：
1. 打开 Finder，找到要移动的文件
2. 选中文件（可按住 `Command` 键多选多个文件）
3. 确保文件已选中（文件会高亮显示）
4. 按下 `Hyper + 2`（即 `⌘` + `⇧` + `⌥` + `2`）
5. 文件会自动移动到 iCloud 的指定目录
6. 屏幕上会显示移动结果："成功移动 X 个文件"或"部分成功 (X/Y)"

**注意**：
- 确保已登录 iCloud 账户
- 确保有足够的 iCloud 存储空间
- 移动操作不可撤销，请谨慎操作

---

#### 任务四：防止电脑休眠

**步骤**：
1. 按下 `Hyper + 5`（即 `⌘` + `⇧` + `⌥` + `5`）
2. 鼠标会开始在屏幕中央区域随机移动
3. 屏幕上会显示提示："鼠标随机移动已启动"
4. 电脑将保持活跃状态，不会进入休眠

**停止鼠标移动**：
- 按下 `Hyper + 6`（即 `⌘` + `⇧` + `⌥` + `6`）
- 屏幕上会显示提示："鼠标随机移动已停止"

**使用场景**：
- 下载大文件时防止电脑休眠
- 演示或展示时保持屏幕常亮
- 需要长时间保持电脑活跃状态

---

#### 任务五：切换窗口全屏

**步骤**：
1. 点击要切换的窗口，使其成为当前活动窗口
2. 按下 `Hyper + P`（即 `⌘` + `⇧` + `⌥` + `P`）
3. 窗口会在全屏模式和窗口模式之间切换

**注意**：
- 再次按下相同的快捷键可以切换回原来的模式
- 适用于大多数应用程序窗口

---

#### 任务六：重新加载配置

**步骤**：
1. 修改配置文件后（例如更改快捷键）
2. 按下 `Hyper + R`（即 `⌘` + `⇧` + `⌥` + `R`）
3. 配置会立即重新加载，无需重启 Hammerspoon
4. 屏幕上会显示提示："Hammerspoon 配置已加载！"

---

## 💻 系统要求

### 操作系统

- **支持的系统**：macOS 10.10 (Yosemite) 或更高版本
- **推荐系统**：macOS 11.0 (Big Sur) 或更高版本

### 必要软件

- **Hammerspoon**：版本 0.9.70 或更高
  - 下载地址：[https://www.hammerspoon.org/](https://www.hammerspoon.org/)
  - 免费开源软件

### 硬件要求

- 任意 Mac 电脑（MacBook、iMac、Mac mini、Mac Pro 等）
- 建议至少 4GB 内存
- 支持多显示器（可选）

### 网络要求

- iCloud 功能需要稳定的网络连接
- 建议使用 Wi-Fi 或有线网络

### 其他要求

- 需要管理员权限（首次安装 Hammerspoon 时）
- 需要登录 iCloud 账户（使用 iCloud 文件移动功能时）

---

## ❓ 常见问题解答（FAQ）

### Q1：快捷键按下后没有反应，怎么办？

**A**：请按照以下步骤检查：

1. **确认 Hammerspoon 已启动**
   - 检查菜单栏是否有 Hammerspoon 图标（锤子形状）
   - 如果没有，请在"应用程序"文件夹中启动 Hammerspoon

2. **确认配置已加载**
   - 点击菜单栏中的 Hammerspoon 图标
   - 选择"Reload Config"选项
   - 查看屏幕是否显示"配置已加载"提示

3. **检查快捷键是否被其他应用占用**
   - 某些应用可能使用了相同的快捷键组合
   - 尝试关闭其他可能冲突的应用

4. **检查配置文件是否正确**
   - 确保所有 `.lua` 文件都在正确的文件夹中
   - 查看配置文件是否有语法错误

---

### Q2：如何修改快捷键？

**A**：修改快捷键非常简单，请按照以下步骤操作：

1. 打开配置文件夹（点击 Hammerspoon 图标 → Open Config）
2. 用文本编辑器打开 `init.lua` 文件
3. 找到要修改的快捷键绑定，例如：
   ```lua
   hs.hotkey.bind(hyper, "M", display.moveWindowToNextScreen)
   ```
4. 修改第二个参数（字母键），例如改为 "N"：
   ```lua
   hs.hotkey.bind(hyper, "N", display.moveWindowToNextScreen)
   ```
5. 保存文件
6. 按下 `Hyper + R` 重新加载配置

**注意**：
- 字母键区分大小写，建议使用大写字母
- 数字键也可以使用，如 "1"、"2" 等
- 避免使用已被系统占用的快捷键

---

### Q3：如何修改 Hyper 键的组合？

**A**：Hyper 键默认是 `Command + Shift + Option`，您可以修改为其他组合：

1. 打开 `init.lua` 文件
2. 找到第 10 行：
   ```lua
   local hyper = {"cmd", "shift", "alt"}
   ```
3. 修改为其他组合，例如：
   ```lua
   local hyper = {"cmd", "alt"}        -- 改为 Cmd + Alt
   local hyper = {"cmd", "ctrl"}       -- 改为 Cmd + Ctrl
   local hyper = {"ctrl", "alt"}       -- 改为 Ctrl + Alt
   ```
4. 保存文件
5. 按下原来的 `Hyper + R` 重新加载配置

**可用的修饰键**：
- `cmd`：Command 键 (⌘)
- `shift`：Shift 键 (⇧)
- `alt`：Option 键 (⌥)
- `ctrl`：Control 键 (⌃)

---

### Q4：iCloud 文件移动失败怎么办？

**A**：如果文件移动失败，请检查以下事项：

1. **检查 iCloud 账户**
   - 确保已登录 iCloud 账户
   - 检查 iCloud 同步是否正常工作

2. **检查目标目录**
   - 打开 `icloud.lua` 文件
   - 找到 `getTargetDirectory()` 函数
   - 确认目标目录路径是否正确：
     ```lua
     return os.getenv("HOME") .. "/Library/Mobile Documents/com~apple~CloudDocs/ITC/2025年/"
     ```
   - 根据需要修改路径

3. **检查文件权限**
   - 确保对源文件和目标目录有读写权限
   - 某些系统文件可能无法移动

4. **检查存储空间**
   - 确保 iCloud 有足够的存储空间
   - 如果空间不足，清理一些文件或升级存储计划

---

### Q5：鼠标自动移动功能会影响正常使用吗？

**A**：鼠标自动移动功能设计为在后台运行，不会影响正常使用：

- 鼠标只在屏幕中央区域随机移动
- 移动间隔为 30 秒，不会过于频繁
- 移动范围有限，不会干扰正常操作
- 可以随时通过 `Hyper + 6` 停止

**建议**：
- 在需要保持电脑活跃时启动
- 在正常工作时停止，避免干扰
- 如果觉得移动过于频繁，可以修改 `mouse.lua` 文件中的时间间隔

---

### Q6：如何卸载或禁用某个功能？

**A**：如果您不需要某个功能，可以通过以下方式禁用：

**方法一：注释掉快捷键绑定**
1. 打开 `init.lua` 文件
2. 在要禁用的快捷键行前添加 `--`，例如：
   ```lua
   -- hs.hotkey.bind(hyper, "5", mouse.startMouseMovement)
   ```
3. 保存文件
4. 按下 `Hyper + R` 重新加载配置

**方法二：删除快捷键绑定**
1. 打开 `init.lua` 文件
2. 直接删除要禁用的快捷键行
3. 保存文件
4. 按下 `Hyper + R` 重新加载配置

**注意**：禁用快捷键不会删除功能模块，只是无法通过快捷键调用。

---

### Q7：Hammerspoon 会影响系统性能吗？

**A**：Hammerspoon 本身非常轻量，对系统性能影响很小：

- 内存占用通常在 10-50MB 之间
- CPU 占用几乎可以忽略不计
- 只在触发功能时才会执行相应操作
- 鼠标自动移动功能运行时会有轻微的 CPU 占用

**建议**：
- 如果担心性能，可以禁用鼠标自动移动功能
- 定期检查 Hammerspoon 的内存占用情况
- 遇到性能问题时，可以重启 Hammerspoon

---

### Q8：如何查看错误日志？

**A**：如果遇到问题，可以通过以下方式查看错误日志：

1. **打开控制台**
   - 打开"应用程序" → "实用工具" → "控制台"
   - 在搜索框中输入"Hammerspoon"
   - 查看相关的错误信息

2. **查看 Hammerspoon 控制台**
   - 点击菜单栏中的 Hammerspoon 图标
   - 选择"Console"选项
   - 查看实时日志输出

3. **检查配置文件**
   - 确保配置文件没有语法错误
   - 检查是否有拼写错误或遗漏的符号

---

### Q9：是否支持多显示器？

**A**：是的，完全支持多显示器：

- 显示器切换功能可以在多个显示器之间移动窗口
- 清除残影功能会清除所有连接的显示器
- 鼠标移动功能在主显示器上运行
- 支持任意数量的显示器

**注意**：
- 确保所有显示器都已正确连接
- 在系统设置中配置好显示器排列
- 某些功能可能在特定显示器配置下表现不同

---

### Q10：如何备份和恢复配置？

**A**：建议定期备份配置文件，以防意外丢失：

**备份配置**：
1. 打开配置文件夹（点击 Hammerspoon 图标 → Open Config）
2. 复制所有 `.lua` 文件到安全位置（如桌面、U盘或云存储）
3. 建议使用版本控制工具（如 Git）管理配置

**恢复配置**：
1. 打开配置文件夹
2. 将备份的 `.lua` 文件复制到该文件夹
3. 如果提示覆盖，选择"替换"
4. 点击 Hammerspoon 图标 → Reload Config

**建议**：
- 定期备份配置文件
- 在修改配置前先备份
- 使用云存储或版本控制工具管理配置

---

## 🆘 获取技术支持

### 官方资源

- **Hammerspoon 官网**：[https://www.hammerspoon.org/](https://www.hammerspoon.org/)
- **Hammerspoon 文档**：[https://www.hammerspoon.org/docs/](https://www.hammerspoon.org/docs/)
- **GitHub 仓库**：[https://github.com/Hammerspoon/hammerspoon](https://github.com/Hammerspoon/hammerspoon)

### 社区支持

- **Hammerspoon 论坛**：[https://groups.google.com/g/hammerspoon](https://groups.google.com/g/hammerspoon)
- **GitHub Issues**：[https://github.com/Hammerspoon/hammerspoon/issues](https://github.com/Hammerspoon/hammerspoon/issues)
- **Reddit 社区**：[https://www.reddit.com/r/hammerspoon/](https://www.reddit.com/r/hammerspoon/)

### 获取帮助

如果您在使用过程中遇到问题，可以通过以下方式获取帮助：

1. **查看文档**：首先查阅本文档和 Hammerspoon 官方文档
2. **搜索问题**：在论坛或 GitHub Issues 中搜索类似问题
3. **提问**：如果找不到解决方案，可以在论坛或 GitHub 上提问
4. **提供信息**：提问时请提供以下信息：
   - macOS 版本
   - Hammerspoon 版本
   - 详细的错误信息或问题描述
   - 相关的配置文件内容

### 联系方式

- **电子邮件**：通过 GitHub Issues 提交问题
- **社交媒体**：关注 Hammerspoon 的官方社交媒体账号
- **即时通讯**：加入 Hammerspoon 的 Slack 或 Discord 群组

---

## 📝 更新日志

### 版本 1.0.0（当前版本）

- 初始版本发布
- 实现显示器管理功能
- 实现窗口全屏切换功能
- 实现 iCloud 文件移动功能
- 实现鼠标自动移动功能
- 提供完整的模块化配置方案
- 添加详细的用户文档

---

## 📄 许可证

本项目基于 MIT 许可证开源，您可以自由使用、修改和分发。

---

## 🙏 致谢

感谢 Hammerspoon 开发团队提供的优秀工具，以及所有贡献者的支持。

---

**祝您使用愉快！** 🎉
